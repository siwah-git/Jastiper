<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pesanan Saya - TitipGo</title>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #f5f7fa;
    }

    .akun-main {
      display: flex;
      max-width: 1200px;
      margin: 0 auto;
      padding: 32px 0 0 0;
      gap: 32px;
    }

    .akun-sidebar {
      width: 260px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
      padding: 24px 18px 18px 18px;
      min-height: 400px;
      margin-top: 0;
    }

    .akun-user-info {
      display: flex;
      align-items: center;
      gap: 14px;
      margin-bottom: 18px;
    }

    .akun-user-icon {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: #f5f7fa;
      object-fit: cover;
    }

    .akun-username {
      font-weight: bold;
      font-size: 16px;
      color: #222;
    }

    .akun-edit-link {
      color: #1976d2;
      font-size: 13px;
      text-decoration: underline;
      margin-top: 2px;
      display: inline-block;
    }

    .akun-menu {
      margin-top: 18px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .akun-menu-item {
      padding: 10px 16px;
      border-radius: 6px;
      color: #333;
      font-size: 15px;
      text-decoration: none;
      transition: background 0.15s, color 0.15s;
    }

    .akun-menu-item.active,
    .akun-menu-item:hover {
      background: #eaf6fa;
      color: #1976d2;
    }

    .akun-content {
      flex: 1;
      min-width: 0;
    }

    .pesanan-content {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
      padding: 32px 28px 28px 28px;
      min-height: 400px;
      flex: 1;
    }

    .pesanan-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 18px;
      flex-wrap: wrap;
    }

    .pesanan-tab {
      padding: 8px 18px;
      border-radius: 12px 12px 0 0;
      background: #f1f5fb;
      color: #ec4899;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      border: 1px solid #f9a8d4;
      border-bottom: none;
      outline: none;
      transition: background 0.15s, color 0.15s;
      text-decoration: none;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
    }

    .pesanan-tab.active,
    .pesanan-tab:focus {
      background: #ec4899;
      color: #fff;
      font-weight: bold;
      box-shadow: 0 2px 8px rgba(236, 72, 153, 0.10);
      border-color: #ec4899;
    }

    .pesanan-tab:not(.active):hover {
      background: #fdf2f8;
      color: #be185d;
    }

    .pesanan-section-title {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 18px;
      color: #222;
    }

    .pesanan-card {
      background: #f8f9fa;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.04);
      margin-bottom: 18px;
      padding: 18px 18px 12px 18px;
      border: 1px solid #e0e0e0;
    }

    .pesanan-store-info {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .pesanan-store-name {
      font-weight: bold;
      font-size: 15px;
      color: #1976d2;
    }

    .pesanan-store-btn {
      background: #fff;
      color: #d2196f;
      border: 1px solid #1976d2;
      border-radius: 4px;
      padding: 4px 16px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    .pesanan-store-btn:hover {
      background: #e3f0ff;
    }

    .pesanan-product {
      display: flex;
      align-items: center;
      gap: 18px;
      margin-bottom: 8px;
    }

    .pesanan-product-image {
      width: 60px;
      height: 60px;
      border-radius: 6px;
      overflow: hidden;
      background: #fff;
      border: 1px solid #e0e0e0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .pesanan-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 6px;
    }

    .pesanan-product-info {
      flex: 1;
      min-width: 0;
    }

    .pesanan-product-name {
      font-size: 15px;
      font-weight: 600;
      color: #222;
      margin-bottom: 2px;
    }

    .pesanan-product-variant {
      font-size: 13px;
      color: #444;
    }

    .pesanan-product-status-completed {
      color: #22c100;
      font-size: 13px;
      font-weight: bold;
      margin-top: 2px;
    }

    .pesanan-product-price {
      font-weight: 600;
      font-size: 15px;
      color: #d32f2f;
      min-width: 120px;
      text-align: right;
    }

    .pesanan-total {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 15px;
      color: #333;
      font-weight: 500;
      margin-top: 8px;
    }

    .pesanan-total-label {
      font-weight: 500;
      color: #333;
    }

    .pesanan-total-amount {
      font-weight: bold;
      color: #d32f2f;
      font-size: 16px;
    }

    .pesanan-actions {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .pesanan-action-btn {
      background: #fff;
      color: #d2196f;
      border: 1px solid #d2197f;
      border-radius: 4px;
      padding: 6px 20px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }

    .pesanan-action-btn:hover {
      background: #e3f0ff;
      color: #1256a3;
    }

    .pesanan-action-btn-active {
      background: #1976d2;
      color: #fff;
      border: 1px solid #1976d2;
    }

    .pesanan-action-btn-active:hover {
      background: #1256a3;
      color: #fff;
    }

    .pesanan-kosong {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px 20px;
      text-align: center;
    }

    .no-orders-icon {
      width: 80px;
      height: 80px;
      opacity: 0.3;
      margin-bottom: 20px;
    }

    .pesanan-kosong h3 {
      font-size: 24px;
      color: #333;
      margin-bottom: 12px;
    }

    .pesanan-kosong p {
      font-size: 16px;
      color: #666;
      margin-bottom: 24px;
    }

    .btn-belanja {
      background: #d2197f;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 12px 24px;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
    }

    .btn-belanja:hover {
      background: #a31267;
    }
  </style>
</head>

<body class="font-sans bg-gray-100 m-0">
  <header class="bg-white shadow-md py-1 px-6 flex justify-between items-center fixed w-full top-0 z-50 mb-8">
    <div class="flex items-center space-x-3">
        <img src="asset/images/titipgo_logo_remove.png" alt="Logo TitipGo" class="w-28 sm:w-32">
        <div class="relative hidden md:block">
            <input type="text" placeholder="Cari Barang..."
                class="header-search pl-10 pr-4 py-2 border border-gray-300 rounded-full w-56 lg:w-64 focus:outline-none focus:border-pink-500">
            <svg class="w-5 h-5 absolute left-2.5 top-2.5 text-gray-500 pointer-events-none" fill="currentColor"
                viewBox="0 0 20 20">
                <path
                    d="M8 4a4 4 0 104 4 4 4 0 00-4-4zM2 8a6 6 0 1110.39 3.94l4.3 4.3-1.42 1.42-4.3-4.3A6 6 0 012 8z" />
            </svg>
        </div>
    </div>
    <nav class="nav-center flex-grow hidden md:flex justify-center items-center gap-6">
    </nav>
    <nav class="flex items-center space-x-4 sm:space-x-6">
        <a href="pembeli_dashboard.html"
            class="hidden md:block text-gray-700 hover:text-pink-600 font-semibold text-base">Beranda</a>
        <div class="dropdown-kategori relative inline-block hidden md:block">
            <a href="pembeli_kategori.html" 
                class="hidden md:block text-gray-700 hover:text-pink-600 font-semibold text-base">Kategori</a>
                        <div class="dropdown-kategori relative inline-block hidden md:block"></div>
        </div>

        <a href="pembeli_keranjang.html" class="relative p-2 text-gray-700 hover:text-pink-600">
            <svg class="icon-nav w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z">
                </path>
            </svg>
        </a>
        <a href="pembeli_notifikasi.html" class="relative p-2 text-gray-700 hover:text-pink-600"> <svg class="icon-nav w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9">
                </path>
            </svg>
        </a>
        <img src="https://cdn-icons-png.flaticon.com/512/747/747376.png" alt="User" class="icon-nav w-6 h-6"
            id="userIcon" style="cursor:pointer;">
        <div id="userDropdown"
            class="hidden absolute right-0 top-[60px] bg-white shadow-lg rounded min-w-[160px] z-[1001]">
            <a href="pembeli_akun.html"
                class="block px-5 py-3 text-gray-900 no-underline text-sm border-b border-gray-100">Akun Saya</a>
            <a href="pembeli_pesanan_saya.html"
                class="block px-5 py-3 text-gray-900 no-underline text-sm border-b border-gray-100">Pesanan</a>
            <a href="#" onclick="openChatCS();return false;"
                class="block px-5 py-3 text-gray-700 no-underline text-sm border-b border-gray-100">Chat dengan
                CS</a>
            <a href="#" onclick="openChatCS();return false;"
                class="block px-5 py-3 text-gray-700 no-underline text-sm border-b border-gray-100">Toko Saya</a>
            <a href="#" onclick="logoutUser();return false;"
                class="block px-5 py-3 text-red-600 no-underline text-sm">Logout</a>
        </div>
    </nav>
</header>
  <main class="pt-32">
    <h1 class="page-title"
      style="text-align:center;font-size:2rem;font-weight:bold;margin:32px 0 16px 0;letter-spacing:1px;">PESANAN SAYA
    </h1>

    <!-- Main Content -->
    <div class="akun-main">
      <!-- Left Sidebar -->
      <div class="akun-sidebar">
        <div class="akun-user-info">
          <img src="https://cdn-icons-png.flaticon.com/512/747/747376.png" alt="User" class="akun-user-icon">
          <div class="akun-user-details">
            <div class="akun-username">dwirestykartika</div>
          </div>
        </div>

        <div class="akun-menu">
          <a href="pembeli_akun.html" class="akun-menu-item">Akun Saya</a>
          <a href="pembeli_pesanan_saya.html" class="akun-menu-item active">Pesanan Saya</a>
          <a href="#" class="akun-menu-item">Notifikasi</a>
        </div>
      </div>

      <!-- Right Content -->
      <div class="bg-white rounded-xl shadow-lg max-w-4xl w-full mx-auto p-6 mt-6">
        <!-- Order Status Tabs -->
        <div class="pesanan-tabs">
          <a href="#" class="pesanan-tab">Semua</a>
          <a href="#" class="pesanan-tab">Belum Dibayar</a>
          <a href="#" class="pesanan-tab">Sedang Dikemas <span class="pesanan-count">(1)</span></a>
          <a href="#" class="pesanan-tab">Dikirim</a>
          <a href="#" class="pesanan-tab active">Selesai</a>
          <a href="#" class="pesanan-tab">Dibatalkan</a>
        </div>

        <!-- Section Title -->
        <h2 class="pesanan-section-title">Pesanan Selesai</h2>

        <!-- Semua box pesanan hanya render dari JS -->
        <div class="pesanan-content"></div>
      </div>
    </div>

    <!-- Modal Rating Pop-up -->
    <div id="ratingModal" class="fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-30 hidden">
      <div class="bg-white rounded-xl shadow-lg max-w-md w-full p-8 mx-auto">
        <h2 class="text-2xl font-bold text-center mb-6">Nilai Produk</h2>
        <!-- Preview Produk -->
        <div class="flex items-center gap-4 bg-gray-100 rounded p-4 mb-6">
          <img src="asset/images/ootd (1).jpg" alt="Produk"
            class="w-16 h-16 rounded object-cover border border-gray-300">
          <div>
            <div class="font-semibold text-base">Baju Gucci G6000 Man Limited Edition</div>
            <div class="text-xs text-gray-500">No Pesanan 7262726G22</div>
            <div class="text-xs text-pink-600 font-semibold">Selesai</div>
          </div>
        </div>
        <!-- Rating Bintang -->
        <form id="ratingForm" class="space-y-6">
          <div>
            <label class="block font-semibold mb-1">Nilai Produk</label>
            <div class="flex gap-1 text-2xl" id="stars-produk">
              <span class="star cursor-pointer">☆</span>
              <span class="star cursor-pointer">☆</span>
              <span class="star cursor-pointer">☆</span>
              <span class="star cursor-pointer">☆</span>
              <span class="star cursor-pointer">☆</span>
            </div>
          </div>
          <div>
            <label class="block font-semibold mb-1">Layanan Jastiper</label>
            <div class="flex gap-1 text-2xl" id="stars-jastiper">
              <span class="star cursor-pointer">☆</span>
              <span class="star cursor-pointer">☆</span>
              <span class="star cursor-pointer">☆</span>
              <span class="star cursor-pointer">☆</span>
              <span class="star cursor-pointer">☆</span>
            </div>
          </div>
          <div>
            <label class="block font-semibold mb-1">Jasa Kirim</label>
            <div class="flex gap-1 text-2xl" id="stars-kirim">
              <span class="star cursor-pointer">☆</span>
              <span class="star cursor-pointer">☆</span>
              <span class="star cursor-pointer">☆</span>
              <span class="star cursor-pointer">☆</span>
              <span class="star cursor-pointer">☆</span>
            </div>
          </div>
          <div class="flex justify-between mt-8">
            <button type="button" onclick="hideRatingModal()"
              class="px-6 py-2 rounded bg-gray-200 text-gray-700 font-semibold hover:bg-gray-300">Kembali</button>
            <button type="submit"
              class="px-6 py-2 rounded bg-pink-600 text-white font-semibold hover:bg-pink-700">Kirim</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Chat Modal -->
    <div id="chatModal" class="fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-30 hidden">
      <div class="bg-white rounded shadow-lg w-[600px] max-w-full border border-gray-400">
        <div class="flex border-b border-gray-300 items-center justify-between px-4 py-2">
          <span class="font-bold text-lg">Chat</span>
          <button onclick="hideChatModal()"
            class="text-gray-500 hover:text-pink-600 text-2xl leading-none">&times;</button>
        </div>
        <div class="flex h-[320px]">
          <!-- Sidebar Kontak -->
          <div class="w-1/3 border-r border-gray-200 p-3 flex flex-col gap-2 bg-gray-50">
            <div class="flex items-center gap-2 p-2 border rounded cursor-pointer hover:bg-pink-50">
              <img src="https://cdn-icons-png.flaticon.com/512/747/747376.png" class="w-7 h-7 rounded-full" />
              <div>
                <div class="font-semibold text-sm">Dwi Store</div>
                <div class="text-xs text-gray-500">Kak pesanannya kapan?</div>
              </div>
            </div>
            <div class="flex items-center gap-2 p-2 border rounded cursor-pointer hover:bg-pink-50">
              <img src="https://cdn-icons-png.flaticon.com/512/747/747376.png" class="w-7 h-7 rounded-full" />
              <div>
                <div class="font-semibold text-sm">Resty Store</div>
                <div class="text-xs text-gray-500">Kak pesanannya kapan?</div>
              </div>
            </div>
            <div class="flex items-center gap-2 p-2 border rounded cursor-pointer hover:bg-pink-50">
              <img src="https://cdn-icons-png.flaticon.com/512/747/747376.png" class="w-7 h-7 rounded-full" />
              <div>
                <div class="font-semibold text-sm">Kartika Store</div>
                <div class="text-xs text-gray-500">Kak pesanannya kapan?</div>
              </div>
            </div>
          </div>
          <!-- Panel Chat Kanan -->
          <div class="flex-1 flex flex-col">
            <div class="p-3 border-b border-gray-200 font-semibold">Apa yang ingin kamu tanyakan?</div>
            <div class="p-3 flex items-center gap-3 border-b border-gray-200">
              <img src="asset/images/ootd (1).jpg" class="w-12 h-12 rounded border border-gray-300" />
              <div>
                <div class="font-medium text-sm">Baju Gucci G6000 Man Limited Edition</div>
                <div class="text-xs text-gray-500">No Pesanan 7262726G22</div>
                <div class="text-xs text-pink-600 font-semibold">Sedang Dikemas</div>
              </div>
            </div>
            <div class="flex-1"></div>
            <div class="border-t border-gray-200 p-2 flex items-center">
              <input type="text" class="flex-1 border-none focus:ring-0 text-sm" placeholder="Tulis Pesan" />
              <button class="ml-2 text-pink-600 font-semibold hover:underline" onclick="sendMessage()">Kirim</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ====== DAFTAR PESANAN DARI FIRESTORE ====== -->
    <div id="orders-list" class="mt-6"></div>

    <script>
      // Dropdown Kategori
      const kategoriMenu = document.getElementById('kategoriMenu');
      const dropdownKategori = document.getElementById('dropdownKategori');
      if (kategoriMenu && dropdownKategori) {
        kategoriMenu.addEventListener('click', function (e) {
          e.preventDefault();
          dropdownKategori.style.display = dropdownKategori.style.display === 'block' ? 'none' : 'block';
        });
        document.addEventListener('click', function (e) {
          if (!kategoriMenu.contains(e.target) && !dropdownKategori.contains(e.target)) {
            dropdownKategori.style.display = 'none';
          }
        });
      }
      // Dropdown User
      const userIcon = document.getElementById('userIcon');
      const userDropdown = document.getElementById('userDropdown');
      if (userIcon && userDropdown) {
        userIcon.onclick = function (e) {
          e.stopPropagation();
          userDropdown.classList.toggle('hidden');
        };
        document.addEventListener('click', function (e) {
          if (!userDropdown.contains(e.target) && e.target !== userIcon) {
            userDropdown.classList.add('hidden');
          }
        });
      }

      // --- Search Functionality ---
      const searchInput = document.querySelector('.header-search');
      if (searchInput) {
        searchInput.addEventListener('keypress', function (e) {
          if (e.key === 'Enter') {
            const searchTerm = this.value;
            if (searchTerm.trim()) {
              alert('Mencari: ' + searchTerm);
            }
          }
        });
      }

      // --- Modal Rating ---
      function showRatingModal() {
        document.getElementById('ratingModal').classList.remove('hidden');
      }
      function hideRatingModal() {
        document.getElementById('ratingModal').classList.add('hidden');
      }
      function makeStarRating(containerId) {
        const container = document.getElementById(containerId);
        const stars = container.querySelectorAll('.star');
        let rating = 0;
        stars.forEach((star, idx) => {
          star.addEventListener('mouseenter', () => {
            stars.forEach((s, i) => s.textContent = i <= idx ? '★' : '☆');
          });
          star.addEventListener('mouseleave', () => {
            stars.forEach((s, i) => s.textContent = i < rating ? '★' : '☆');
          });
          star.addEventListener('click', () => {
            rating = idx + 1;
            stars.forEach((s, i) => s.textContent = i < rating ? '★' : '☆');
          });
        });
        container.dataset.rating = rating;
      }
      makeStarRating('stars-produk');
      makeStarRating('stars-jastiper');
      makeStarRating('stars-kirim');
      document.getElementById('ratingForm').addEventListener('submit', function (e) {
        e.preventDefault();
        alert('Terima kasih atas rating Anda!');
        hideRatingModal();
      });

      // --- Modal Chat ---
      function showChatModal() {
        document.getElementById('chatModal').classList.remove('hidden');
      }
      function hideChatModal() {
        document.getElementById('chatModal').classList.add('hidden');
      }

      // --- Chat Send ---
      const chatInput = document.querySelector('.chat-quick-input');
      if (chatInput) {
        chatInput.addEventListener('keypress', function (e) {
          if (e.key === 'Enter') sendMessage();
        });
      }
      function sendMessage() {
        const input = document.querySelector('#chatModal input[type="text"]');
        if (input && input.value.trim()) {
          alert('Terima kasih, pesan Anda telah dikirim!');
          input.value = '';
        }
      }

      // --- Chat Contact Selection ---
      document.querySelectorAll('.chat-contact').forEach(function (contact) {
        contact.addEventListener('click', function () {
          document.querySelectorAll('.chat-contact').forEach(c => c.classList.remove('active'));
          this.classList.add('active');
        });
      });

      // --- Notifikasi & Kunjungi Toko ---
      function showNotifications() {
        alert('Anda memiliki 3 notifikasi baru!');
      }
      function kunjungiToko() {
        alert('Fitur kunjungi toko akan segera hadir!');
      }

      // --- Dropdown User Icon Akun ---
      function logoutUser() {
        alert('Berhasil logout!');
        if (userDropdown) userDropdown.classList.add('hidden');
      }
      function openChatCS() {
        alert('Fitur chat CS akan segera hadir!');
        if (userDropdown) userDropdown.classList.add('hidden');
      }

      // --- Pesanan ---
      let orders = [];
      let currentTab = 'sedang-dikemas';
      function loadOrders() {
        orders = JSON.parse(localStorage.getItem('orders') || '[]');
        if (orders.some(order => order.status === 'Sedang Dikemas')) {
          currentTab = 'sedang-dikemas';
        } else if (orders.length > 0) {
          currentTab = 'semua';
        }
        displayOrders();
      }
      // --- Pesanan Selesai ---
      function pesananSelesai(orderIndex) {
        if (confirm('Apakah Anda yakin pesanan sudah selesai?')) {
          orders[orderIndex].status = 'Selesai';
          localStorage.setItem('orders', JSON.stringify(orders));
          currentTab = 'selesai';
          displayOrders();
        }
      }
      // --- Display Orders Dinamis ---
      function displayOrders() {
        const content = document.querySelector('.pesanan-content');
        let filteredOrders = [];
        let sectionTitle = '';
        switch (currentTab) {
          case 'semua': filteredOrders = orders; sectionTitle = 'Semua Pesanan'; break;
          case 'belum-dibayar': filteredOrders = orders.filter(order => order.status === 'Belum Dibayar'); sectionTitle = 'Pesanan Belum Dibayar'; break;
          case 'sedang-dikemas': filteredOrders = orders.filter(order => order.status === 'Sedang Dikemas'); sectionTitle = 'Pesanan Sedang Dikemas'; break;
          case 'dikirim': filteredOrders = orders.filter(order => order.status === 'Dikirim'); sectionTitle = 'Pesanan Dikirim'; break;
          case 'selesai': filteredOrders = orders.filter(order => order.status === 'Selesai'); sectionTitle = 'Pesanan Selesai'; break;
          case 'dibatalkan': filteredOrders = orders.filter(order => order.status === 'Dibatalkan'); sectionTitle = 'Pesanan Dibatalkan'; break;
        }
        document.querySelector('.pesanan-section-title').textContent = sectionTitle;
        if (filteredOrders.length === 0) {
          content.innerHTML = `<div class="pesanan-kosong"><img src="https://cdn-icons-png.flaticon.com/512/263/263142.png" alt="No Orders" class="no-orders-icon"><h3>Tidak ada pesanan</h3><p>Belum ada pesanan dengan status ini.</p><button class="btn-belanja" onclick="window.location.href='pembeli_produk_gucci.html'">Mulai Belanja</button></div>`;
          return;
        }
        content.innerHTML = filteredOrders.map((order, index) => {
          let actionButtons = '';
          if (order.status === 'Sedang Dikemas') {
            actionButtons = `
        <button class="border border-pink-600 rounded px-4 py-2 bg-pink-600 text-white mr-2 hover:bg-pink-700 hover:border-pink-700" onclick="pesananSelesai(${index})">Pesanan Selesai</button>
        <button class="border border-pink-600 rounded px-4 py-2 bg-pink-600 text-white hover:bg-pink-700 hover:border-pink-700" onclick="showChatModal()">Hubungi Penjual</button>
      `;
          } else if (order.status === 'Selesai') {
            actionButtons = `
        <button class="border border-pink-600 rounded px-4 py-2 bg-pink-600 text-white mr-2 hover:bg-pink-700 hover:border-pink-700" onclick="showRatingModal()">Nilai</button>
        <button class="border border-pink-600 rounded px-4 py-2 bg-pink-600 text-white hover:bg-pink-700 hover:border-pink-700" onclick="showChatModal()">Hubungi Penjual</button>
      `;
          } else {
            actionButtons = `<button class="border border-pink-600 rounded px-4 py-2 bg-pink-600 text-white hover:bg-pink-700 hover:border-pink-700" onclick="showChatModal()">Hubungi Penjual</button>`;
          }
          return `
      <div class="border border-gray-300 rounded bg-white mt-2 mb-8">
        <div class="flex justify-between items-center px-4 py-2 border-b border-gray-200">
          <div class="flex items-center gap-2">
            <span class="font-bold text-base">${order.products && order.products[0] && order.products[0].store ? order.products[0].store : (order.store || 'Rifal Store')}</span>
            <button class="px-2 py-1 border border-pink-600 rounded bg-pink-600 text-white text-xs hover:bg-pink-700 hover:border-pink-700 ml-2" onclick="kunjungiToko()">Kunjungi Toko</button>
          </div>
          <span class="text-sm text-gray-700">Pesanan ${order.status}</span>
        </div>
        <div class="flex flex-row gap-4 px-4 py-4 items-center">
          <img src="asset/images/ootd (1).jpg" alt="Baju Gucci" class="w-20 h-20 object-cover rounded border border-gray-200">
          <div class="flex-1">
            <div class="font-semibold text-base mb-1">${order.products && order.products[0] ? order.products[0].name : 'Baju Gucci G6000 Man Limited Edition'}</div>
            <div class="text-gray-600 text-sm mb-1">${order.products && order.products[0] ? (order.products[0].variant || order.products[0].color + ', ' + order.products[0].size + ' (' + order.products[0].quantity + ')') : 'Hitam, M (2)'}</div>
          </div>
          <div class="text-right min-w-[120px]">
            <div class="text-red-600 font-semibold text-base">Rp. ${order.products && order.products[0] ? order.products[0].price.toLocaleString('id-ID') : '3.000.000'}</div>
          </div>
        </div>
        <div class="flex justify-end items-center px-4 pb-4">
          <div class="mr-8 text-base">Total Pesanan: <span class="text-red-600 font-semibold">Rp. ${(order.total || (order.products && order.products[0] ? order.products[0].price * (order.products[0].quantity || 1) : 6300000)).toLocaleString('id-ID')}</span></div>
          ${actionButtons}
        </div>
      </div>
    `;
        }).join('');
      }

      // Tab Navigation
      const pesananTabs = document.querySelectorAll('.pesanan-tab');
      pesananTabs.forEach(function (tab) {
        tab.addEventListener('click', function (e) {
          e.preventDefault();
          pesananTabs.forEach(t => t.classList.remove('active'));
          this.classList.add('active');
          const tabText = this.textContent.toLowerCase();
          if (tabText.includes('semua')) currentTab = 'semua';
          else if (tabText.includes('belum dibayar')) currentTab = 'belum-dibayar';
          else if (tabText.includes('sedang dikemas')) currentTab = 'sedang-dikemas';
          else if (tabText.includes('dikirim')) currentTab = 'dikirim';
          else if (tabText.includes('selesai')) currentTab = 'selesai';
          else if (tabText.includes('dibatalkan')) currentTab = 'dibatalkan';
          displayOrders();
        });
      });

      // Load orders saat halaman dimuat
      window.onload = function () {
        loadOrders();
      };
    </script>

    <!-- Integrasi Firebase Firestore -->
    <script type="module">
      import { db, auth } from './js/firebase-config.js';
      import { collection, query, where, getDocs } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';

      async function loadOrdersFromFirestore() {
        const userId = localStorage.getItem('userId');
        const q = query(collection(db, "orders"), where("userId", "==", userId));
        const querySnapshot = await getDocs(q);
        const orders = [];
        querySnapshot.forEach((doc) => {
          orders.push({ id: doc.id, ...doc.data() });
        });
        // Render ke HTML
        const container = document.getElementById('orders-list');
        if (!orders.length) {
          container.innerHTML = '<div class="text-gray-500 text-center py-8">Belum ada pesanan.</div>';
          return;
        }
        container.innerHTML = orders.map(order => `
          <div class="border p-4 rounded mb-4 bg-white shadow">
            <div class="mb-2 flex flex-wrap justify-between items-center">
              <div><b>ID:</b> ${order.id}</div>
              <div class="text-pink-600 font-semibold">${order.status}</div>
            </div>
            <div class="mb-1"><b>Total:</b> Rp. ${order.total.toLocaleString('id-ID')}</div>
            <div class="mb-1"><b>Alamat:</b> ${order.alamat}</div>
            <div class="mb-1"><b>Metode Bayar:</b> ${order.metodeBayar || '-'}</div>
            <div><b>Produk:</b> ${order.products.map(p => `${p.varian || ''} x${p.qty || 1}`).join(', ')}</div>
          </div>
        `).join('');
      }
      window.addEventListener('DOMContentLoaded', loadOrdersFromFirestore);
    </script>

     <footer class="bg-blue-900 py-8 px-6 mt-8"> <div class="container mx-auto flex flex-wrap justify-between items-start text-white text-sm"> <div class="w-full sm:w-1/3 mb-6 sm:mb-0">
            <h3 class="font-bold text-white mb-3">INFORMASI</h3> <ul>
                <li class="mb-2"><a href="pembeli_tentang_kami.html" class="hover:text-pink-600">Tentang Kami</a></li>
                <li class="mb-2"><a href="pembeli_pertanyaan_umum.html" class="hover:text-pink-600">Pertanyaan Umum</a></li>
                <li class="mb-2"><a href="pembeli_hubungi_kami.html" class="hover:text-pink-600">Hubungi Kami</a></li>
            </ul>
        </div>
        <div class="w-full sm:w-1/3 flex justify-center items-center mb-6 sm:mb-0">
            <img src="asset/images/titipgo_logo_remove.png" alt="TitipGo Logo" class="w-32">
        </div>
        <div class="w-full sm:w-1/3 text-right">
            <h3 class="font-bold text-white mb-3">IKUTI SOSIAL MEDIA KAMI</h3> <ul>
                <li class="mb-2 flex items-center justify-end"><i class="fab fa-instagram mr-2"></i><a href="https://www.instagram.com/restiidr_?igsh=MXkwbXQ5OHgxdnJteQ%3D%3D&utm_source=qr" target="_blank" class="hover:text-pink-600">Instagram</a></li>
                <li class="mb-2 flex items-center justify-end"><i class="fab fa-facebook mr-2"></i><a href="https://www.instagram.com/sitiiwhy_?igsh=MTk4aWtnbTBmaWZyZQ==" target="_blank" class="hover:text-pink-600">Facebook</a></li>
                <li class="mb-2 flex items-center justify-end"><i class="fab fa-youtube mr-2"></i><a href="https://www.instagram.com/okay_5527?igsh=MXVkODNpNTNrZ3kwbg==" target="_blank" class="hover:text-pink-600">Youtube</a></li>
            </ul>
        </div>
    </div>
    <div class="text-center text-white text-xs mt-8 opacity-75"> © 2025 TitipGo. All rights reserved.
    </div>
</footer>
</body>

</html>